# Persistent domain
#
# All previous patterns for this domain were removed in handover from Guidelines v0.3 to v2.0 (see https://github.com/AGLDWG/guidelines)
# in August, 2018.
#
# All patterns here will be built up from approved entries in the AGLDWG PID Allocations Catalogue (http://catalogue.linked.data.gov.au/)
# Nick Car, 13/08/2018
#
<VirtualHost *>
        ServerName linked.data.gov.au

        RewriteEngine  on

        ServerAdmin webmaster@localhost
        ErrorLog ${APACHE_LOG_DIR}/linked.data.gov.au/error.log
        CustomLog ${APACHE_LOG_DIR}/linked.data.gov.au/access.log combined

        Options Includes FollowSymLinks MultiViews

        #
        #	PIDs
        #

        #
        #	Definitional resources
        #

        # http://linked.data.gov.au/def/gnaf
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/gnaf(.*)$ http://gnafld.net/def/gnaf$1.ttl?  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/gnaf(.*)$ http://gnafld.net/def/gnaf$1.ttl  [R=302,L]
        RewriteRule ^/def/gnaf(.*).ttl$ http://gnafld.net/def/gnaf$1.ttl  [R=302,L]
        RewriteRule ^/def/gnaf(.*)$ http://gnafld.net/def/gnaf$1 [R=302,L]


        # http://linked.data.gov.au/def/reg-status
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/reg-status(.*)$ http://www.linked.data.gov.au/def/reg-status$1.ttl?  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/reg-status(.*)$ http://www.linked.data.gov.au/def/reg-status$1.ttl  [R=302,L]
        RewriteRule ^/def/reg-status(.*).ttl$ http://www.linked.data.gov.au/def/reg-status$1.ttl  [R=302,L]
        RewriteRule ^/def/reg-status(.*)$ http://www.linked.data.gov.au/def/reg-status$1 [R=302,L]


        # http://linked.data.gov.au/def/placenames
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/placenames(.*)$ http://www.linked.data.gov.au/def/placenames$1.ttl?  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/placenames(.*)$ http://www.linked.data.gov.au/def/placenames$1.ttl  [R=302,L]
        RewriteRule ^/def/placenames(.*).ttl$ http://www.linked.data.gov.au/def/placenames$1.ttl [R=302,L]
        RewriteRule ^/def/placenames(.*)$ http://www.linked.data.gov.au/def/placenames$1 [R=302,L]
        

        # http://linked.data.gov.au/def/agrif
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/agrif(.*)$ http://www.linked.data.gov.au/def/agrif.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/agrif(.*)$ http://www.linked.data.gov.au/def/agrif$1.ttl [R=302,L]
        RewriteRule ^/def/agrif(.*).ttl$ http://www.linked.data.gov.au/def/agrif$1.ttl [R=302,L]
        RewriteRule ^/def/agrif(.*)$ http://www.linked.data.gov.au/def/agrif$1 [R=302,L]


        # http://linked.data.gov.au/def/asgs
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/asgs(.*)$ http://www.linked.data.gov.au/def/asgs.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/asgs(.*)$ http://www.linked.data.gov.au/def/asgs$1.ttl [R=302,L]
        RewriteRule ^/def/asgs(.*).ttl$ http://www.linked.data.gov.au/def/asgs$1.ttl [R=302,L]
        RewriteRule ^/def/asgs(.*)$ http://www.linked.data.gov.au/def/asgs$1 [R=302,L]


        # http://linked.data.gov.au/def/iso19160-1-address
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/iso19160-1-address(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address$1.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/iso19160-1-address(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address$1.ttl [R=302,L]
        RewriteRule ^/def/iso19160-1-address(.*).ttl$ http://www.linked.data.gov.au/def/iso19160-1-address$1.ttl [R=302,L]
        RewriteRule ^/def/iso19160-1-address(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address$1 [R=302,L]


        # http://linked.data.gov.au/def/iso19160-1-address-nz-profile
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/iso19160-1-address-nz-profile(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address-nz-profile$1.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/iso19160-1-address-nz-profile(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address-nz-profile$1.ttl [R=302,L]
        RewriteRule ^/def/iso19160-1-address-nz-profile(.*).ttl$ http://www.linked.data.gov.au/def/iso19160-1-address-nz-profile$1.ttl [R=302,L]
        RewriteRule ^/def/iso19160-1-address-nz-profile(.*)$ http://www.linked.data.gov.au/def/iso19160-1-address-nz-profile$1 [R=302,L]


        # http://linked.data.gov.au/def/dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/dataset(.*)$ http://www.linked.data.gov.au/def/dataset.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/dataset(.*)$ http://www.linked.data.gov.au/def/dataset$1.ttl [R=302,L]
        RewriteRule ^/def/dataset(.*).ttl$ http://www.linked.data.gov.au/def/dataset$1.ttl [R=302,L]
        RewriteRule ^/def/dataset(.*)$ http://www.linked.data.gov.au/def/dataset$1 [R=302,L]


        # http://linked.data.gov.au/def/fsdf
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/fsdf(.*)$ http://www.linked.data.gov.au/def/fsdf.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/fsdf(.*)$ http://www.linked.data.gov.au/def/fsdf$1.ttl [R=302,L]
        RewriteRule ^/def/fsdf(.*).ttl$ http://www.linked.data.gov.au/def/fsdf$1.ttl [R=302,L]
        RewriteRule ^/def/fsdf(.*)$ http://www.linked.data.gov.au/def/fsdf$1 [R=302,L]


        # http://linked.data.gov.au/def/loci
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/loci(.*)$ http://www.linked.data.gov.au/def/loci.ttl? [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/loci(.*)$ http://www.linked.data.gov.au/def/loci$1.ttl [R=302,L]
        RewriteRule ^/def/loci(.*).ttl$ http://www.linked.data.gov.au/def/loci$1.ttl [R=302,L]
        RewriteRule ^/def/loci(.*)$ http://www.linked.data.gov.au/def/loci$1 [R=302,L]

        # http://linked.data.gov.au/def/gba
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=ttl [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=ttl [R=302,L]
        RewriteRule ^/def/gba(.*).ttl$ http://registry2.it.csiro.au/def/gba$1?_format=ttl [R=302,L]
        RewriteCond %{QUERY_STRING} ^_format=application/ld+json$
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=jsonld [R=302,L]
        RewriteCond %{HTTP:Accept} application/ld+json [NC]
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=jsonld [R=302,L]
        RewriteRule ^/def/gba(.*).jsonld$ http://registry2.it.csiro.au/def/gba$1?_format=jsonld [R=302,L]
        RewriteCond %{QUERY_STRING} ^_format=application/rdf+xml$
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=rdf [R=302,L]
        RewriteCond %{HTTP:Accept} application/rdf+xml [NC]
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1?_format=rdf [R=302,L]
        RewriteRule ^/def/gba(.*).rdf$ http://registry2.it.csiro.au/def/gba$1?_format=rdf [R=302,L]        
        RewriteRule ^/def/gba(.*)$ http://registry2.it.csiro.au/def/gba$1 [R=302,L]

        #
        #	Datasets
        #

        # http://linked.data.gov.au/dataset/gnaf
	    # Dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf$                         http://gnafld.net/index.ttl?  [R=302,L]
        RewriteRule ^/dataset/gnaf.ttl$                     http://gnafld.net/index.ttl  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf$                         http://gnafld.net/index.ttl  [R=302,L]
        RewriteRule ^/dataset/gnaf$                         http://gnafld.net  [R=302,L]
	    # Top-level Registers
	    RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf/(.*)/$                   http://gnafld.net/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf/(.*)/index.ttl$          http://gnafld.net/$1/?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf/(.*)/$                   http://gnafld.net/$1/?_format=text/turtle [R=302,L]
	    RewriteRule ^/dataset/gnaf/(.*)/$                   http://gnafld.net/$1/ [R=302,L]
        # sub-dataset objects
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf/(.*)$                    http://gnafld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf/(.*).ttl$                http://gnafld.net/$1?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf/(.*)$                    http://gnafld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf/(.*)$                    http://gnafld.net/$1 [R=302,L]


        # http://linked.data.gov.au/dataset/gnaf-2016-05
	    # Dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf-2016-05$                 http://gnafld.net/2016-05/index.ttl?  [R=302,L]
        RewriteRule ^/dataset/gnaf-2016-05.ttl$             http://gnafld.net/2016-05/index.ttl  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf-2016-05$                 http://gnafld.net/2016-05/index.ttl  [R=302,L]
        RewriteRule ^/dataset/gnaf-2016-05$                 http://gnafld.net/2016-05  [R=302,L]
	    # Top-level Registers
	    RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf-2016-05/(.*)/$           http://gnafld.net/2016-05/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf-2016-05/(.*)/index.ttl$  http://gnafld.net/2016-05/$1/?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf-2016-05/(.*)/$           http://gnafld.net/2016-05/$1/?_format=text/turtle [R=302,L]
	    RewriteRule ^/dataset/gnaf-2016-05/(.*)/$           http://gnafld.net/2016-05/$1/ [R=302,L]
        # sub-dataset objects
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/gnaf-2016-05/(.*)$            http://gnafld.net/2016-05/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf-2016-05/(.*).ttl$        http://gnafld.net/2016-05/$1?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/gnaf-2016-05/(.*)$            http://gnafld.net/2016-05/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/gnaf-2016-05/(.*)$            http://gnafld.net/2016-05/$1 [R=302,L]


        # http://linked.data.gov.au/dataset/geofabric
        # Dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/geofabric$                     http://geofabricld.net/index.ttl?  [R=302,L]
        RewriteRule ^/dataset/geofabric.ttl$                 http://geofabricld.net/index.ttl  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/geofabric$                     http://geofabricld.net/index.ttl  [R=302,L]
        RewriteRule ^/dataset/geofabric$                     http://geofabricld.net  [R=302,L]
        # Top-level Registers
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/geofabric/(.*)/$               http://geofabricld.net/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/geofabric/(.*)/index.ttl$      http://geofabricld.net/$1/?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/geofabric/(.*)/$               http://geofabricld.net/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/geofabric/(.*)/$               http://geofabricld.net/$1/ [R=302,L]
        # sub-dataset objects
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/geofabric/(.*)$                http://geofabricld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/geofabric/(.*).ttl$            http://geofabricld.net/$1?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/geofabric/(.*)$                http://geofabricld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/geofabric/(.*)$                http://geofabricld.net/$1 [R=302,L]


        # http://linked.data.gov.au/dataset/data-policies
        # Dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/data-policies$                 http://licences.csiro.au/index.ttl?  [R=302,L]
        RewriteRule ^/dataset/data-policies.ttl$             http://licences.csiro.au/index.ttl  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/data-policies$                 http://licences.csiro.au/index.ttl  [R=302,L]
        RewriteRule ^/dataset/data-policies$                 http://licences.csiro.au/  [R=302,L]
        # Top-level Registers
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/data-policies/(.*)/$           http://licences.csiro.au/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/data-policies/(.*)/index.ttl$  http://licences.csiro.au/$1/?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/data-policies/(.*)/$           http://licences.csiro.au/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/data-policies/(.*)/$           http://licences.csiro.au/$1/ [R=302,L]
        # sub-dataset objects
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/data-policies/(.*)/(.*)$       http://licences.csiro.au/$1/?uri=http://linked.data.gov.au$0&_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/data-policies/(.*)/(.*).ttl$   http://licences.csiro.au/$1/?uri=http://linked.data.gov.au/dataset/data-policies/$1/$2&_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/data-policies/(.*)/(.*)$       http://licences.csiro.au/$1/?uri=http://linked.data.gov.au$0&_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/data-policies/(.*)/(.*)        http://licences.csiro.au/$1/?uri=http://linked.data.gov.au$0 [R=302,L]

        # http://linked.data.gov.au/dataset/asgs2016
        # Dataset
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/asgs2016$                     http://asgsld.net/index.ttl?  [R=302,L]
        RewriteRule ^/dataset/asgs2016.ttl$                 http://asgsld.net/index.ttl  [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/asgs2016$                     http://asgsld.net/index.ttl  [R=302,L]
        RewriteRule ^/dataset/asgs2016$                     http://asgsld.net/  [R=302,L]
        # Top-level Registers
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/asgs2016/(.*)/$               http://asgsld.net/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/asgs2016/(.*)/index.ttl$      http://asgsld.net/$1/?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/asgs2016/(.*)/$               http://asgsld.net/$1/?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/asgs2016/(.*)/$               http://asgsld.net/$1/ [R=302,L]
        # sub-dataset objects
        RewriteCond %{QUERY_STRING} ^_format=text/turtle$
        RewriteRule ^/dataset/asgs2016/(.*)$                http://asgsld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/asgs2016/(.*).ttl$            http://asgsld.net/$1?_format=text/turtle [R=302,L]
        RewriteCond %{HTTP:Accept} text/turtle [NC]
        RewriteRule ^/dataset/asgs2016/(.*)$                http://asgsld.net/$1?_format=text/turtle [R=302,L]
        RewriteRule ^/dataset/asgs2016/(.*)$                http://asgsld.net/$1 [R=302,L]


        # http://linked.data.gov.au/dataset/energy
        # Datasets
        RewriteRule ^/dataset/energy/$                      https://near.csiro.au/assets/ [R=302,L]
        RewriteRule ^/dataset/energy/(.*)$                  https://near.csiro.au/assets/$1 [R=302,L]


	# Linksets

	# Addresses / Catchments
	RewriteRule ^/linkset/bhafqv$                      https://github.com/CSIRO-enviro-informatics/addressescatchments-linkset [R=302,L]

        #
        #       AGLDWG website - legacy link redirector
        #

        #
        #       All new www.linked.data.gov.au patterns must be added to www.linked.data.gov.au.conf, not here
        #
        RewriteRule   /([a-z]+)(.html)?  http://www.linked.data.gov.au/$1  [R=302,L]
        RewriteRule   /  http://www.linked.data.gov.au/  [R=302,L]
</VirtualHost>
